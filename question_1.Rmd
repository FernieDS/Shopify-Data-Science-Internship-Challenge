---
title: "Solution to Question 1"
author: "Sumayyah Musa"
date: "4/28/2021"
output: html_document
keep_md: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(dplyr)
library(ggplot2)
```

### On Shopify, we have exactly 100 sneaker shops, and each of these shops sells only one model of shoe. We want to do some analysis of the average order value (AOV). When we look at orders data over a 30 day window, we naively calculate an AOV of $3145.13. Given that we know these shops are selling sneakers, a relatively affordable item, something seems wrong with our analysis. 

* Think about what could be going wrong with our calculation. Think about a better way to evaluate this data. 
* What metric would you report for this dataset?
* What is its value?

#### Read in the data

```{r}
data <- read.csv("2019 Winter Data Science Intern Challenge Data Set - Sheet1.csv")
glimpse(data) #glimpse the data
```

On glimpsing the data, the class of order_id, shop_id and user_id were all 'integer', therefore we will change them to 'character' variables.

```{r}
data$order_id <- as.character(data$order_id)
data$shop_id <- as.character(data$shop_id)
data$user_id <- as.character(data$user_id)

glimpse(data)
```

```{r}
sum(is.na(data))
```

No missing values in our data

```{r}
summary(data$order_amount)
```

Summary statistics of the order amount, showing the mean, minimum, maximum and interquartile values

```{r}
mean(data$order_amount)
```

* From the above mean value calculated, it indicated that the mean value of the total order amount for all the shops was calculated, when in fact we are trying to get the average order value (AOV), which means the average amount spent each time a customer places an order for the sneakers over a 30-day period.

* A better way to evaluate the AOV is to calculate it for each sneaker shop by dividing the total revenue made by the total number of orders for each shop.

```{r}
data_aov <- data %>%
        group_by(shop_id) %>%
        summarize(aov_per_shop = sum(order_amount)/sum(total_items)) #%>%
        #arrange(desc(aov_per_shop))
```


```{r}
#arrange our output in ascending orders
data_aov %>%
        arrange(aov_per_shop)
```

This showed no extreme values.

```{r}
#Arrange our output in descending orders
data_aov %>%
        arrange(desc(aov_per_shop))
```

The AOV for shop 78 seems very high and extreme, given that the sneakers are all rlatively affordable, we will filter out the values for Shop 78 to further examine the issue.

```{r}
filter(data, shop_id == 78) 
```

The order amount for 1 sneaker seems to have been inputed as $25725, which is plausible. We will assume that the order amount was mistakenly inputed in cents instead of dollars. We will therefore convert the AOV of shop 78 into dollars, by dividing its aov_per_shop value by 100. 25725/100 = 257.25

```{r}
data_aov <- data_aov %>% 
                mutate(aov_per_shop = case_when(
                        aov_per_shop == 25725 ~ 257.25,
                        TRUE ~ aov_per_shop
                ))
```


```{r}
data_aov %>%
        arrange(aov_per_shop)
```

Write our output into a csv file name AOV.csv

```{r}
write.csv(data_aov, "AOV.csv")
```













